{
  "id": 109,
  "title": "main",
  "body": "from pathlib import Path\nfrom modules.document_store import DocumentStore\nfrom modules.command_processor import CommandProcessor\nfrom modules.gui_tkinter import DemoKitGUI\nfrom modules.ai_interface import AIInterface\n# Plugins\nfrom modules.memory_dialog  import open_memory_dialog\nfrom modules.opml_extras_plugin import install_opml_extras_into_app\nfrom modules.save_as_text_plugin_v3 import install_save_as_text_into_app\nfrom modules.image_render_overlay import attach_image_rendering\n# NOTE: Do NOT import the old modules.opml_extras_plugin.\n# NOTE: Do NOT import export_doc_patch; gui_tkinter already has robust _export_doc.\n\ndef main():\n    # Ensure the storage directory exists\n    Path(\"storage\").mkdir(parents=True, exist_ok=True)\n\n    # Initialize the document store\n    doc_store = DocumentStore(\"storage/documents.db\")\n\n    # Initialize the AI interface\n    ai = AIInterface()\n\n    # Initialize the command processor with doc store and AI\n    processor = CommandProcessor(doc_store, ai)\n\n    # Launch the GUI\n    app = DemoKitGUI(doc_store, processor)\n    attach_image_rendering(app)\n    open_memory_dialog(app)   # adds Tools \u2192 Memory\u2026 and Ctrl+M\n\n    # Wire plugins\n    install_opml_extras_into_app(app)      # URL\u2192OPML, Convert\u2192OPML, Batch Convert\n    install_save_as_text_into_app(app)     # Save Binary As Text (DB-safe)\n\n    app.mainloop()\n\nif __name__ == \"__main__\":\n    main()\n\n"
}