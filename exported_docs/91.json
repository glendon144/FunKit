{
  "id": 91,
  "title": "google_system",
  "body": "import os\nfrom google.auth.transport.requests import Request\nfrom google.oauth2.credentials import Credentials\nfrom google.auth.oauthlib import flow\nfrom googleapiclient.discovery import build\nimport pandas as pd\n\ndef get_credentials():\n    creds = None\n    if os.path.exists('token.json'):\n        creds = Credentials.from_authorized_user_file('token.json', ['https://www.googleapis.com/auth/drive'])\n    if not creds or not creds.valid:\n        if creds and creds.expired and creds.refresh_token:\n            creds.refresh(Request())\n        else:\n            print(\"No valid credentials found. Please follow the instructions to generate credentials.\")\n            flow = flow.InstalledAppFlow.from_client_secrets_file(\n                'credentials.json', ['https://www.googleapis.com/auth/drive'])\n            creds = flow.run_local_server(port=0)\n        with open('token.json', 'w') as token:\n            token.write(creds.to_json())\n    return creds\n\ndef get_drive_service(creds):\n    return build('drive', 'v3', credentials=creds)\n\ndef download_files_from_folder(drive_service, folder_id, download_path):\n    query = f\"'{folder_id}' in parents and trashed=false\"\n    results = drive_service.files().list(q=query).execute()\n    files = results.get('files', [])\n    for file in files:\n        file_id = file['id']\n        file_name = file['name']\n        request = drive_service.files().get_media(fileId=file_id)\n        file_path = f\"{download_path}/{file_name}\"\n        with open(file_path, 'wb') as f:\n            f.write(request.execute())\n        print(f\"Downloaded {file_name} to {file_path}\")\n\ndef process_files(local_path):\n    # Your processing logic here\n    for file in os.listdir(local_path):\n        if file.endswith('.csv'):\n            df = pd.read_csv(os.path.join(local_path, file))\n            # Process your data here\n            print(df.head())\n\nif __name__ == \"__main__\":\n    credentials_path = input(\"Enter the path to your credentials.json file: \")\n    if not os.path.exists('credentials.json'):\n        print(\"Credentials file not found. Please download it from the Google Cloud Console and save it as 'credentials.json' in the same directory as this script.\")\n    else:\n        creds = get_credentials()\n        drive_service = get_drive_service(creds)\n        \n        folder_id = input(\"Enter Google Drive folder ID: \")\n        download_path = './downloads'\n        os.makedirs(download_path, exist_ok=True)\n\n        download_files_from_folder(drive_service, folder_id, download_path)\n        process_files(download_path)\n"
}